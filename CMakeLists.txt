project(minc-toolkit)
cmake_minimum_required(VERSION 2.6)

SET(MINK_TOOLKIT_PACKAGE_VERSION_MAJOR 0)
SET(MINK_TOOLKIT_PACKAGE_VERSION_MINOR 1)
SET(MINK_TOOLKIT_PACKAGE_VERSION_PATCH 0)

SET(CPACK_GENERATOR TGZ DEB RPM)
SET(CPACK_PACKAGE_VERSION_MAJOR ${MINK_TOOLKIT_PACKAGE_VERSION_MAJOR})
SET(CPACK_PACKAGE_VERSION_MINOR ${MINK_TOOLKIT_PACKAGE_VERSION_MINOR})
SET(CPACK_PACKAGE_VERSION_PATCH ${MINK_TOOLKIT_PACKAGE_VERSION_PATCH})

INCLUDE(CPack)

# register local modules
SET(CMAKE_MODULE_PATH "${CMAKE_MODULE_PATH}" "${CMAKE_SOURCE_DIR}/cmake-modules")

# required packages
# required for minc
FIND_PACKAGE(ZLIB REQUIRED)
FIND_PACKAGE(NETCDF REQUIRED)
FIND_PACKAGE(HDF5 REQUIRED)
FIND_PACKAGE(Perl REQUIRED)
#required for some minc tools
FIND_PACKAGE(BISON)
FIND_PACKAGE(FLEX)

#required for bicpl
FIND_PACKAGE(NETPBM REQUIRED )

#required for oobicpl
FIND_PACKAGE( PCRE REQUIRED )
FIND_PACKAGE( PCRE++ REQUIRED )

#required for EZminc
FIND_PACKAGE(GSL)
FIND_PACKAGE(FFTW3F)
#required for minc4itk & EZminc
FIND_PACKAGE(ITK QUIET)

#required for ray_trace
FIND_PACKAGE( Threads )
FIND_PACKAGE( GLUT REQUIRED )


SET(MINC_TOOLKIT_BUILD ON)
SET(MINC_TOOLKIT_BUILD_DIR ${CMAKE_BINARY_DIR})
SET(MINC_TOOLKIT_INSTALL_DIR ${CMAKE_INSTALL_PREFIX})

ADD_SUBDIRECTORY(minc)

SET(MINC2_USE_FILE ${CMAKE_BINARY_DIR}/minc/UseMINC2.cmake CACHE INTERNAL "MINC2 use file")
INCLUDE(${CMAKE_BINARY_DIR}/minc/MINC2Config.cmake)
INCLUDE(${MINC2_USE_FILE})

ADD_SUBDIRECTORY(EBTKS)
SET(EBTKS_USE_FILE ${CMAKE_BINARY_DIR}/EBTKS/UseEBTKS.cmake CACHE INTERNAL "EBTKS use file")
INCLUDE(${CMAKE_BINARY_DIR}/EBTKS/EBTKSConfig.cmake)
INCLUDE(${EBTKS_USE_FILE})

ADD_SUBDIRECTORY(bicpl)
SET(BICPL_USE_FILE ${CMAKE_BINARY_DIR}/bicpl/UseBICPL.cmake CACHE INTERNAL "BICPL use file")
INCLUDE(${CMAKE_BINARY_DIR}/bicpl/BICPLConfig.cmake)
INCLUDE(${BICPL_USE_FILE})

ADD_SUBDIRECTORY(arguments)
SET(ARGUMENTS_USE_FILE ${CMAKE_BINARY_DIR}/bicpl/UseARGUMENTS.cmake CACHE INTERNAL "ARGUMENTS use file")
INCLUDE(${CMAKE_BINARY_DIR}/arguments/ARGUMENTSConfig.cmake)
INCLUDE(${ARGUMENTS_USE_FILE})

ADD_SUBDIRECTORY(oobicpl)
SET(OOBICPL_USE_FILE ${CMAKE_BINARY_DIR}/bicpl/UseOOBICPL.cmake CACHE INTERNAL "OOBICPL use file")
INCLUDE(${CMAKE_BINARY_DIR}/oobicpl/OOBICPLConfig.cmake)
INCLUDE(${OOBICPL_USE_FILE})


ADD_SUBDIRECTORY(conglomerate)
ADD_SUBDIRECTORY(EZminc)
ADD_SUBDIRECTORY(classify)
ADD_SUBDIRECTORY(N3)
ADD_SUBDIRECTORY(glim_image)
ADD_SUBDIRECTORY(mni_autoreg)
ADD_SUBDIRECTORY(inormalize)
ADD_SUBDIRECTORY(ray_trace)
